<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>ATtiny85 Template Code: shared/systicks.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ATtiny85 Template Code
   </div>
   <div id="projectbrief">Code snippets for the ATtiny85</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('systicks_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">systicks.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;avr/io.h&gt;</code><br/>
<code>#include &lt;avr/interrupt.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="hardware_8h_source.html">../hardware.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="systicks_8h_source.html">systicks.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="iohelp_8h_source.html">iohelp.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for systicks.c:</div>
<div class="dyncontent">
<div class="center"><img src="systicks_8c__incl.png" border="0" usemap="#shared_2systicks_8c" alt=""/></div>
<map name="shared_2systicks_8c" id="shared_2systicks_8c">
<area shape="rect" id="node4" href="hardware_8h.html" title="../hardware.h" alt="" coords="5,80,104,107"/><area shape="rect" id="node5" href="systicks_8h.html" title="systicks.h" alt="" coords="269,80,351,107"/><area shape="rect" id="node8" href="iohelp_8h.html" title="iohelp.h" alt="" coords="179,80,245,107"/></map>
</div>
</div>
<p><a href="systicks_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a26c24ccec205f6f0a41c12f4bb29c7da"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="systicks_8c.html#a26c24ccec205f6f0a41c12f4bb29c7da">SPWM_MAX</a>&#160;&#160;&#160;4</td></tr>
<tr class="separator:a26c24ccec205f6f0a41c12f4bb29c7da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e9ccc4c1f5feec98be6fa3b0f646bde"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="systicks_8c.html#a0e9ccc4c1f5feec98be6fa3b0f646bde">TICKLETS</a>&#160;&#160;&#160;64</td></tr>
<tr class="separator:a0e9ccc4c1f5feec98be6fa3b0f646bde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99d519632c3bbe9fe647b21affaabdd7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="systicks_8c.html#a99d519632c3bbe9fe647b21affaabdd7">SYSTICK_ENABLED</a></td></tr>
<tr class="separator:a99d519632c3bbe9fe647b21affaabdd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4804383164f309da61e6dd01814d1ed5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="systicks_8c.html#a4804383164f309da61e6dd01814d1ed5">ticksInit</a> ()</td></tr>
<tr class="separator:a4804383164f309da61e6dd01814d1ed5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0cb8a748b6da925b5e9a8b80a34ca06"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="systicks_8c.html#ad0cb8a748b6da925b5e9a8b80a34ca06">ticks</a> ()</td></tr>
<tr class="separator:ad0cb8a748b6da925b5e9a8b80a34ca06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03ce66270994a32a2265f27cc3231d04"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="systicks_8c.html#a03ce66270994a32a2265f27cc3231d04">ticksElapsed</a> (uint16_t reference)</td></tr>
<tr class="separator:a03ce66270994a32a2265f27cc3231d04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88ec370107fd5255e4300b8fce114bb2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="systicks_8c.html#a88ec370107fd5255e4300b8fce114bb2">spwmInit</a> ()</td></tr>
<tr class="separator:a88ec370107fd5255e4300b8fce114bb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc1d51e3c1952795f61a36024dd91b6c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="systicks_8c.html#abc1d51e3c1952795f61a36024dd91b6c">spwmOut</a> (<a class="el" href="iohelp_8h.html#a6c6abe9907bd5e5384f46f8ee8d41d47">SPWM</a> pwm, uint8_t value)</td></tr>
<tr class="separator:abc1d51e3c1952795f61a36024dd91b6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa752dba29d62c9aa5d3494e9457d0422"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="systicks_8c.html#aa752dba29d62c9aa5d3494e9457d0422">spwmValue</a> (<a class="el" href="iohelp_8h.html#a6c6abe9907bd5e5384f46f8ee8d41d47">SPWM</a> pwm)</td></tr>
<tr class="separator:aa752dba29d62c9aa5d3494e9457d0422"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab16889ae984b9b798989a0d239283cac"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="systicks_8c.html#ab16889ae984b9b798989a0d239283cac">ISR</a> (TIMER1_OVF_vect)</td></tr>
<tr class="separator:ab16889ae984b9b798989a0d239283cac"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a26c24ccec205f6f0a41c12f4bb29c7da"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SPWM_MAX&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="systicks_8c_source.html#l00015">15</a> of file <a class="el" href="systicks_8c_source.html">systicks.c</a>.</p>

</div>
</div>
<a class="anchor" id="a99d519632c3bbe9fe647b21affaabdd7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SYSTICK_ENABLED</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="systicks_8c_source.html#l00022">22</a> of file <a class="el" href="systicks_8c_source.html">systicks.c</a>.</p>

</div>
</div>
<a class="anchor" id="a0e9ccc4c1f5feec98be6fa3b0f646bde"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TICKLETS&#160;&#160;&#160;64</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="systicks_8c_source.html#l00018">18</a> of file <a class="el" href="systicks_8c_source.html">systicks.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ab16889ae984b9b798989a0d239283cac"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ISR </td>
          <td>(</td>
          <td class="paramtype">TIMER1_OVF_vect&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Interrupt handler </p>

<p>Definition at line <a class="el" href="systicks_8c_source.html#l00170">170</a> of file <a class="el" href="systicks_8c_source.html">systicks.c</a>.</p>

</div>
</div>
<a class="anchor" id="a88ec370107fd5255e4300b8fce114bb2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void spwmInit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialise the software PWM system</p>
<p>Sets up software PWM support. Using the software PWM implementation also enables the system ticks module (they share the same interrupt). </p>

<p>Definition at line <a class="el" href="systicks_8c_source.html#l00107">107</a> of file <a class="el" href="systicks_8c_source.html">systicks.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="systicks_8c_a88ec370107fd5255e4300b8fce114bb2_cgraph.png" border="0" usemap="#systicks_8c_a88ec370107fd5255e4300b8fce114bb2_cgraph" alt=""/></div>
<map name="systicks_8c_a88ec370107fd5255e4300b8fce114bb2_cgraph" id="systicks_8c_a88ec370107fd5255e4300b8fce114bb2_cgraph">
<area shape="rect" id="node2" href="systicks_8c.html#a4804383164f309da61e6dd01814d1ed5" title="ticksInit" alt="" coords="129,5,197,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="abc1d51e3c1952795f61a36024dd91b6c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void spwmOut </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="iohelp_8h.html#a6c6abe9907bd5e5384f46f8ee8d41d47">SPWM</a>&#160;</td>
          <td class="paramname"><em>pwm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the value of a software PWM pin</p>
<p>Set the output for a software PWM pin.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pwm</td><td>the software PWM output to change </td></tr>
    <tr><td class="paramname">value</td><td>the value for the duty cycle ranging from 0 (fully off) to 255 (fully on). </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="systicks_8c_source.html#l00140">140</a> of file <a class="el" href="systicks_8c_source.html">systicks.c</a>.</p>

</div>
</div>
<a class="anchor" id="aa752dba29d62c9aa5d3494e9457d0422"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t spwmValue </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="iohelp_8h.html#a6c6abe9907bd5e5384f46f8ee8d41d47">SPWM</a>&#160;</td>
          <td class="paramname"><em>pwm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the current value of a software PWM pin</p>
<p>Returns the current value of a software PWM pin.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pwm</td><td>the software PWM output to query</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the current value of the software PWM pin </dd></dl>

<p>Definition at line <a class="el" href="systicks_8c_source.html#l00153">153</a> of file <a class="el" href="systicks_8c_source.html">systicks.c</a>.</p>

</div>
</div>
<a class="anchor" id="ad0cb8a748b6da925b5e9a8b80a34ca06"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t ticks </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the current tick count</p>
<dl class="section return"><dt>Returns</dt><dd>the current tick count. The count wraps around once it reaches 65535. </dd></dl>

<p>Definition at line <a class="el" href="systicks_8c_source.html#l00070">70</a> of file <a class="el" href="systicks_8c_source.html">systicks.c</a>.</p>

</div>
</div>
<a class="anchor" id="a03ce66270994a32a2265f27cc3231d04"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t ticksElapsed </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>reference</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate the ticks elapsed since the given sample.</p>
<p>This function calculates the number of ticks that have elapsed since the reference sample was taken. The function takes into account the wrap around of the counter (but it cannot detect multiple wrap arounds).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">reference</td><td>the reference tick count to calculate against.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the number of ticks elapsed since the reference count. </dd></dl>

<p>Definition at line <a class="el" href="systicks_8c_source.html#l00084">84</a> of file <a class="el" href="systicks_8c_source.html">systicks.c</a>.</p>

</div>
</div>
<a class="anchor" id="a4804383164f309da61e6dd01814d1ed5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ticksInit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialise the 'ticks' subsystem.</p>
<p>This function sets up the required interrupts and initialises the tick counter. There are approximately TICKS_PER_SECOND ticks every second that elapses (depending on interrupt activity and clock accuracy) and they are tracked by a 16 bit counter. A program can use the difference between samples of the counter to measure longer periods of time.</p>
<p>The ticks system uses TIMER1 to provide the interrupt used to update the time count (this interrupt is shared with the software PWM implementation as well). </p>

<p>Definition at line <a class="el" href="systicks_8c_source.html#l00054">54</a> of file <a class="el" href="systicks_8c_source.html">systicks.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="systicks_8c_a4804383164f309da61e6dd01814d1ed5_icgraph.png" border="0" usemap="#systicks_8c_a4804383164f309da61e6dd01814d1ed5_icgraph" alt=""/></div>
<map name="systicks_8c_a4804383164f309da61e6dd01814d1ed5_icgraph" id="systicks_8c_a4804383164f309da61e6dd01814d1ed5_icgraph">
<area shape="rect" id="node2" href="iohelp_8h.html#a88ec370107fd5255e4300b8fce114bb2" title="spwmInit" alt="" coords="123,5,197,32"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_9982052f7ce695d12571567315b2fafa.html">shared</a></li><li class="navelem"><a class="el" href="systicks_8c.html">systicks.c</a></li>
    <li class="footer">Generated on Tue May 20 2014 10:05:52 for ATtiny85 Template Code by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
